<div class="container">
  <mat-toolbar class="toolbar" color="primary">
    <div class="toolbar__side-content">
      @if (isLoggedIn | async) {
        @if (stats$ | async; as statItem) {
          <div class="stats">
            <mat-icon class="stats__icon">done_all</mat-icon>
            <div class="stats__numbers">
              <span class="stats__numbers__learned">{{ statItem.learnedEntryCount }}</span>
              <span class="stats__numbers__total">/ {{ statItem.totalEntryCount }}</span>
            </div>
          </div>
        }
      }
    </div>

    <header class="toolbar__header">
      <button class="app-name-button" mat-button (click)="onLogoClick()">
        <div class="app-name-button__content">
          <img src="assets/logo.png" />
          <span>LINQUA</span>
        </div>
      </button>
    </header>

    <div class="toolbar__side-content toolbar__side-content-right">
      @if (isLoggedIn | async) {
        <img class="avatar" [src]="user.photoURL || 'assets/generic-avatar.png'" [matMenuTriggerFor]="menu" />
        <mat-menu #menu="matMenu" yPosition="below">
          <button mat-menu-item (click)="logout()">
            <mat-icon>exit_to_app</mat-icon>
            <span>logout</span>
          </button>
        </mat-menu>
      }
    </div>
  </mat-toolbar>

  <main>
    @switch (state) {
      @case (states.LoggedIn) {
        <app-home></app-home>
      }
      @case (states.HandleLoginRedirect) {
        <div class="handle-login-redirect-container">
          Just a moment, verifying login...
          <div class="spinner">
            <mat-spinner mode="indeterminate" [diameter]="40" [strokeWidth]="5"></mat-spinner>
          </div>
        </div>
      }
      @case (states.LoginNeeded) {
        <app-login [redirectAuthResult]="redirectAuthResult" (loginSuccess)="onLoginSuccess()"></app-login>
      }
      @default {}
    }
  </main>

  <footer></footer>
</div>
